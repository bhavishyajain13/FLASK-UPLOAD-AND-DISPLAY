import pandas as pd

# Read the Excel file
file_path = 'path_to_your_excel_file.xlsx'  # Update with the path to your Excel file
df = pd.read_excel(file_path, sheet_name='Sheet1')  # Update 'Sheet1' with the name of the sheet you want to query

# Define your query
query = 'column_name > 10'  # Update 'column_name > 10' with your query

# Apply the query
filtered_df = df.query(query)

# Write the filtered data to a new sheet in the same Excel file
with pd.ExcelWriter(file_path, mode='a', engine='openpyxl') as writer:
    filtered_df.to_excel(writer, sheet_name='Filtered_Data', index=False)

print("Filtered data has been written to a new sheet 'Filtered_Data'.")


import pandas as pd

# Read the Excel file
file_path = 'path_to_your_excel_file.xlsx'  # Update with the path to your Excel file
xls = pd.ExcelFile(file_path)

# Initialize a dictionary to store the 10th row of each subsheet
tenth_rows = {}

# Iterate over each sheet in the Excel file
for sheet_name in xls.sheet_names:
    # Read the sheet into a DataFrame
    df = pd.read_excel(file_path, sheet_name=sheet_name)
    # Extract the 10th row and store it in the dictionary
    tenth_rows[sheet_name] = df.iloc[9]  # 10th row index is 9 in zero-based indexing

# Print the 10th row of each subsheet
for sheet_name, row in tenth_rows.items():
    print(f"Sheet: {sheet_name}")
    print(row)
    print()  # Add a newline for readability


import pandas as pd

# Read the Excel file
file_path = 'path_to_your_excel_file.xlsx'  # Update with the path to your Excel file
xls = pd.ExcelFile(file_path)

# Initialize a dictionary to store the data of each subsheet
subsheet_data = {}

# Iterate over each sheet in the Excel file
for sheet_name in xls.sheet_names:
    # Read the sheet into a DataFrame, skipping the first 9 rows
    df = pd.read_excel(file_path, sheet_name=sheet_name, skiprows=9)
    # Store the DataFrame in the dictionary
    subsheet_data[sheet_name] = df

# Write the subsheet data to a new Excel file
output_file_path = 'path_to_output_excel_file.xlsx'  # Update with the desired output file path
with pd.ExcelWriter(output_file_path) as writer:
    for sheet_name, df in subsheet_data.items():
        df.to_excel(writer, sheet_name=sheet_name, index=False)

print(f"New Excel file '{output_file_path}' has been created with rows before the 10th row removed from each subsheet.")

